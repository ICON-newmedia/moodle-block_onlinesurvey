define("block_onlinesurvey/modal-zoom",["jquery","core/templates","core/modal","core/modal_registry","core/modal_factory","core/modal_events"],(function($,templates,Modal,ModalRegistry,ModalFactory,ModalEvents){var popupinfotitle="",popupinfocontent="",userlogintime=0,doRefresh=function(){var myElement=document.getElementById("block_onlinesurvey_contentframe");if(myElement){var oldsrc=myElement.src;myElement.src="",myElement.src=oldsrc}},handleClickSmallModal=function(e){e.preventDefault();var modalPromise,originalIframe=e.target.querySelector("iframe"),templatePromise=null;modalPromise=ModalFactory.create({type:ModalFactory.types.DEFAULT,large:!0,title:""}),null!==originalIframe||(originalIframe=parent.document.querySelector("iframe")),templatePromise=templates.render("block_onlinesurvey/modal-iframe",{src:originalIframe.src+"&modalZoom=1",title:""}),$.when(templatePromise,modalPromise).done((function(source,iframemodal){iframemodal.setBody(source),iframemodal.getModal().addClass("modal-xl"),iframemodal.getRoot().on(ModalEvents.hidden,(function(){doRefresh()})),iframemodal.show()}))};return{init:function(popuptitle,popupcontent,currentlogin){popupinfotitle=popuptitle,popupinfocontent=popupcontent,userlogintime=currentlogin;for(var zoomContainer=document.querySelectorAll("#block_onlinesurvey_surveys_content"),i=0;i<zoomContainer.length;i++)zoomContainer[i].addEventListener("click",handleClickSmallModal);window.EVASYS={generatepopupinfo:this.generatepopupinfo},window.evasysGeneratePopupinfo=this.generatepopupinfo},generatepopupinfo:function(){var popupinfo=sessionStorage.getItem("onlinesurvey_popupinfo");0!=popupinfo&&null!==popupinfo&&popupinfo==userlogintime||(sessionStorage.setItem("onlinesurvey_popupinfo",userlogintime),ModalFactory.create({type:ModalFactory.types.DEFAULT,body:popupinfocontent,title:popupinfotitle,large:!0}).done((function(popupmodal){popupmodal.getModal().addClass("modal-xl"),popupmodal.getRoot().on(ModalEvents.hidden,(function(){doRefresh()})),popupmodal.show()})))}}}));

//# sourceMappingURL=modal-zoom.min.js.map